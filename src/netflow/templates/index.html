<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Type" content="text/html;charset=utf8">
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <meta name="robots" content="noindex, nofollow">

    <link rel="stylesheet" type="text/css" href="static/css/thirdparty.min.css">
    <link rel="stylesheet" type="text/css" href="static/css/main.css">
    <link rel="stylesheet" type="text/css" href="static/css/media.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.min.js"></script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>

    <script src="static/js/application.js"></script>

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>
<body>
<div class="container">
  <div class="jumbotron">
    <h1>DK-APT Detection System</h1>
    <p>By DanhLe, KienHo</p>
    <button id="toggle-help-btn" class="btn btn-info">How to Use</button>
  </div>
  
  <!-- Help/Instructions Section -->
  <div id="help-section" style="display: none; background-color: #e8f4f8; border: 1px solid #b8daff; border-radius: 4px; padding: 20px; margin-bottom: 20px;">
    <h3>How to Use This System</h3>
    <p><strong>Step 0: Train/Build Your Own Model!</strong></p>
    <ul>
      <li>Visit the repository: <a href="https://github.com/KienHoSD/NIDS_Fusion-Anomal-E" target="_blank">NIDS_Fusion-Anomal-E</a></li>
      <li>Base on the <strong>Anomal_E_*</strong> files to load your own dataset</li>
      <li>Build your own models based on your dataset, the dataset should have Attack Labels similar to NF-CSE-CIC-IDS2018</li>
      <li>Scale the dataset to your preferable scale and quantity, then testing different algorithms (remember the best parameters after grid search that give the highest scores)</li>
      <li>Save the trained models into the <strong>netflow_ndpi/src/netflow/models/</strong> folder</li>
      <li>Make sure the models are named properly to be detected by this system (e.g., <strong>best_dgi_CSE_multiclass_*.pkl</strong>, <strong>best_catboost_classifier_*.cbm/pkl/json</strong>, <strong>best_dgi_CSE_anomaly_*.pkl</strong>)</li>
      <li>For <strong>anomaly detection models</strong> (DGI model): Use all benign flows</li>
      <li>For <strong>multiclass detection models</strong> (DGI model and CatBoost model): Use balanced flows from labeled dataset</li>
      <li>You can look at the <strong>Scores.ods</strong> file to have insight of the benchmark results across algorithms</li>
    </ul>
    
    <p><strong>Step 1: Load Models</strong></p>
    <ul>
      <li>Select the desired DGI Multiclass Model, Multiclass Classify Model, and DGI Anomaly Model from the dropdowns</li>
      <li>Click "Load Models" to initialize them</li>
      <li>Default models are pre-loaded for immediate use</li>
    </ul>
    
    <p><strong>Step 2: Upload Anomaly Detection Flows (Optional)</strong></p>
    <ul>
      <li>Upload a CSV file containing flow data for anomaly detection (have at least 43 NetFlow V2 features) </li>
      <li>Configure the anomaly detection parameters (Max Flows, N, Contamination)</li>
      <li>Click "Upload & Detect" to train the Anomaly Model</li>
    </ul>
    
    <p><strong>Step 3: Monitor Network Flows</strong></p>
    <ul>
      <li>Use the <strong>Live</strong> mode to see flows in real-time as they are captured</li>
      <li>Use the <strong>Refresh</strong> button to reload the current view</li>
      <li>Use the <strong>Show Range</strong> feature to filter flows by ID range</li>
      <li>Use the <strong>Go to Flow Detail</strong> textbox to jump directly to a specific flow's detail page</li>
    </ul>
    
    <p><strong>Step 4: Analyze Results</strong></p>
    <ul>
      <li>View flow predictions and probabilities in the table</li>
      <li>Check the "Anomaly" column to see normal/anomalous classification</li>
      <li>Click "Detail" to see full flow information and visualizations</li>
    </ul>
    
    <button id="toggle-help-close-btn" class="btn btn-default" style="margin-top: 10px;">Close</button>
  </div>
</div>
    


<div class="container" id="content">
    <!-- Model Selection Panel -->
    <div class="panel panel-info" style="margin-bottom: 20px;">
        <div class="panel-heading">
            <h4 class="panel-title">Model Selection</h4>
        </div>
        <div class="panel-body">
            <div class="row">
                <div class="col-md-4">
                    <label for="dgi-multiclass-model-select">DGI Multiclass Model:</label>
                    <select id="dgi-multiclass-model-select" class="form-control"></select>
                    <p style="font-size: 12px; color: #666; margin-top: 5px;">Current: <strong id="current-dgi-multiclass-model">Loading...</strong></p>
                </div>
                <div class="col-md-4">
                    <label for="multiclass-model-select">Multiclass Classify Model:</label>
                    <select id="multiclass-model-select" class="form-control"></select>
                    <p style="font-size: 12px; color: #666; margin-top: 5px;">Current: <strong id="current-multiclass-model">Loading...</strong></p>
                </div>
                <div class="col-md-4">
                    <label for="dgi-anomaly-model-select">DGI Anomaly Model:</label>
                    <select id="dgi-anomaly-model-select" class="form-control"></select>
                    <p style="font-size: 12px; color: #666; margin-top: 5px;">Current: <strong id="current-dgi-anomaly-model">Loading...</strong></p>
                </div>
            </div>
            <div class="row" style="margin-top: 10px;">
                <div class="col-md-2">
                    <button id="load-models-btn" class="btn btn-primary btn-block">Load Models</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Anomaly Detection Flows Panel -->
    <div class="panel panel-warning" style="margin-bottom: 20px;">
        <div class="panel-heading">
            <h4 class="panel-title">Anomaly Detection Flows</h4>
        </div>
        <div class="panel-body">
            <div class="row">
                <div class="col-md-3">
                    <label for="anomaly-flows-file">Upload Flows CSV:</label>
                    <input type="file" id="anomaly-flows-file" class="form-control" accept=".csv">
                </div>
                <div class="col-md-2">
                    <label for="max-flows-input">Max Flows:</label>
                    <input type="number" id="max-flows-input" class="form-control" value="100000" min="1">
                </div>
                <div class="col-md-2">
                    <label for="n-estimators-input">N:</label>
                    <input type="number" id="n-estimators-input" class="form-control" value="50" min="1">
                </div>
                <div class="col-md-2">
                    <label for="contamination-input">Contamination:</label>
                    <input type="number" id="contamination-input" class="form-control" value="0.01" min="0.001" max="1" step="0.001">
                </div>
                <div class="col-md-2">
                    <label for="anomaly-algorithm-select">Algorithm:</label>
                    <select id="anomaly-algorithm-select" class="form-control">
                        <option value="IF">IsolationForest</option>
                        <option value="CBLOF">CBLOF</option>
                        <option value="HBOS">HBOS</option>
                        <option value="PCA">PCA</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label>&nbsp;</label>
                    <button id="upload-anomaly-flows-btn" class="btn btn-warning btn-block">Upload & Detect</button>
                </div>
            </div>
            <div class="row" style="margin-top: 10px;">
                <div class="col-md-12">
                    <p style="font-size: 12px; color: #666;">Status: <strong id="anomaly-flows-status">No file loaded</strong></p>
                </div>
            </div>
        </div>
    </div>

    <canvas width = 60 height = 20 id="myChart"></canvas>
    <div class="row" style="margin-bottom: 15px;">
        <h3>Captured flow:</h3>
        <div style="margin-bottom: 10px;">
            <label for="flow-detail-input">Go to Flow Detail:</label>
            <input type="number" id="flow-detail-input" placeholder="Enter flow ID" style="width: 150px; padding: 5px; margin: 0 5px;">
            <button id="go-to-flow-detail-btn" class="btn btn-sm btn-info">Open Detail</button>
            <div id="pagination-controls-container" style="display: inline-block; margin-left: 20px;"></div>
        </div>
        <div id="log" style="max-height: 700px; overflow-y: auto; overflow-x: auto; border: 1px solid #ddd;">
        <table width="100%" border="1" cellpadding="2" cellspacing="0" class="display compact" id="details">
        </table>
        </div> <!-- /#log -->
    </div>
</div>
<noscript>
  <div id="noscript">
      Javascript is disabled in your browser. You must have Javascript enabled to utilize the functionality of this page.
  </div>
</noscript>


</body>
</html>
